<html>
   <head>
      <title>XML Tractor</title>
      <meta charset="utf-8"><!-- meta --></meta>
      <style type="text/css" id="xmljellysandwich_css">
      
#XTractor { margin: 0.5em; padding: 0.5em; border: thin solid black;
  background-color: lemonchiffon; color: black }

#XTractor > *:first-child { margin-top: 0em }
#XTractor > *:last-child { margin-bottom: 0em }


html, body
  { background-color: lightsteelblue }
  
a       { color: inherit; font-family: sans-serif; font-size: 90%; text-decoration: none }
a:hover { text-decoration: underline }

      </style>
     
     <!--<script type="text/javascript" src="../lib/zip.js"><!-\- yea verily yea -\-></script>-->
     <script type="text/javascript"
              src="../lib/jszip.min.js"><!-- parsers are so easily confused --></script>
     <script type="text/javascript"
              src="../lib/saxon/SaxonJS.min.js"><!-- parsers are so easily confused --></script>
     <script type="text/javascript"
              src="xtraction.js"><!-- parsers are so easily confused --></script>
     <!--<script>
            
window.onload = function() {
  SaxonJS.transform({
    sourceLocation:     "document.xml",
    stylesheetLocation: "plain.sef",
    initialTemplate:    "xmljellysandwich_pack"
  });
}
     </script>--> 
     
   </head>
   <body>
      <div id="xmljellysandwich_header">
         <h1 id="xmljellysandwich_title"><!-- target with
      <xsl:result-document href="#xmljellysandwich_title"> .... </xsl:result-document>
    --></h1>
      </div>
     <div>
       
       
       
       <h3>XSweet HTML XTractor</h3>
       <p style="font-style: italic">Load your .docx file here ... <input type="file" id="file" name="file" title="Drop docx"/></p>
       <p style="font-style: italic; margin-left: 20%">... all the data conversion happens <b>on your system</b></p>
       
       
     </div>
      <!--<div id="xmljellysandwich_directory"><!-\- target with
      <xsl:result-document href="#xmljellysandwich_directory"> .... </xsl:result-document>
    -\-></div>-->
      <div id="XTractor">
        <p>... Patience while waiting for the XSweet HTML XTractor ...</p>
      <div>
        <h5>What is the XSweet HTML XTractor</h5>
        <p>Internally, Word's <code>docx</code> format is expressed as XML. <a
            href="http://gitlab.coko.foundation/XSweet/XSweet">XSweet</a> provides an XSLT
          transformation that can convert this XML into a rough-and-ready but tolerable HTML, a
            <em>lingua franca</em> for your browser. Using <a
            href="http://www.saxonica.com/saxon-js/index.xml">SaxonJS</a>, an XSLT processor
          implemented in Javascript, this conversion can be performed in memory on your system. No
          file is uploaded to the cloud or indeed copied anywhere: a Javascript utility (JSZip) is
          simply used to read the <code>docx</code> file you designate on your file system, and XML
          discovered therein passed to SaxonJS for processing. If you are reading this, it is
          already set up to run.</p>
      </div>
      <div>
        <h5>Installation Instructions.</h5>
        <p>None. The scripts and configurations are loaded with this page so you are ready to
          go.</p>
      </div>
      <div>
        <h5>Running the XTractor</h5>
        <p>Use the button above to select a <code>docx</code> file on your system. Most of the time,
          dragging a file icon onto this button also works.</p>
        <p>Be patient: depending on the size, complexity and <q>code quality</q> of your
            <code>docx</code> input, conversion can take a bit of time (probably more than a few
          seconds but less than minutes). You may also have to click through warnings from your
          browser, if it is set to complain about time or resource usage.</p>
      </div>
      <div>
        <h5>Limitations</h5>
      </div>
      <p>As noted, because JSZip has to read the <code>docx</code> and its contents must be parsed
        for transformation, there will be some latency especially in a browser already loaded with
        pages. If you have trouble, be patient and/or start with a fresh browser runtime. So far,
        the XSweet HTML XTractor has been tested in Firefox and Chrome.</p>
      <p>In this preliminary implementation, footnotes and endnotes are not handled and Word styles
        are not integrated. Also there's lots more optimization to do over these crude file outputs
        to make them passable code, not only legible on screen. (And XSweet includes much more logic
        than has been invoked so far.)</p>
      <p>Among other things, you will find this means the page code comes out noisy, reflecting
        issues of formatting (consistency) in the <code>docx</code> input. In subsequent versions
        the XTractor may include ways of cleaning this up.</p>
      <p>Until more interface design work is prioritized, there is no ready way to save out your
        HTML results.</p>
      <p class="note">Note: no warranty offered or implied. If your browser crashes, please restart
        with apologies.</p>
        
      </div>
      <div id="xmljellysandwich_footer">
         <p>XML+XSLT under JS in the browser using <a href="http://www.saxonica.com/saxon-js/index.xml">SaxonJS</a>, from
            <a href="http://www.saxonica.com">Saxonica</a>, with help from <a href="http://github.com/wendellpiez/XMLjellysandwich">XML Jelly Sandwich</a>.</p>
        <p><a href="gitlab.coko.foundation/XSweet/">XSweet</a> is supported by the <a href="coko.foundation">Coko Foundation</a></p>
      </div>
   </body>
</html>
